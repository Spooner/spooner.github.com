-# Vertical menu / Sitemap

%nav.menu
  %ul
    %li{ style: "margin-bottom:1em;" }= link_to_unless_current "Home", '/'

    - home.children.select {|i| i.title }.each do |item|

      %li
        = link_to_unless_current item.title, item.path

        %ul
          - if item.identifier == '/blog/'
            - item.children.select {|i| i.path =~ %r[^/blog/\d{4}/$] }.reverse_each do |year|
              %li= link_to_unless_current "#{year.title} (#{articles.count {|i| i.year.to_s == year.name }})", year.path

            - tags = item.children.find {|i| i.name == 'tags' }
            = link_to_unless_current "#{tags.title} (#{tags.children.size})", tags.path

          - else
            - item.children.each do |project|
              %li
                - if project == @item
                  %span{ title: "You're here." }
                    %img.app_icon_small{alt: "#{project.title}", src: "/images/small_icon/#{project.name}.png"}
                    = project.title

                - else
                  %a{href: project.path}
                    %img.app_icon_small{alt: "#{project.title}", src: "/images/small_icon/#{project.name}.png"}
                    = project.title


    %li= link_to "Github", "http://github.com/Spooner"
    %li= link_to "deviantART", "http://lemonsails.deviantart.com"
    %li= link_to "YouTube", "http://www.youtube.com/user/spoonerspon"